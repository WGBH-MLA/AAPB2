<% content_for :main do %>

  <ol class="breadcrumb hidden-xs exhibit-show-breadcrumb" style="margin-top: 0px;">
    <li>◄ <a href="/exhibits">Exhibits</a></li>
    
    <% @exhibit.ancestors.map do |ancestor| %>
    
      <li>◄ <%= link_to ancestor.title, "/exhibits/#{ancestor.path}" %></li>
    
    <% end %>
    
    <li><%= @exhibit.title %></li>
  </ol>

  <div class="row">
      
    <div class="col-md-8">


      <div class="row">
 
        <div class="col-md-7"></div>

        <div class="col-md-5">
            <%= render partial: 'sidebar_nav',
                       locals: {
                          title: 'Select from exhibit themes',
                          links: (@exhibit.children.empty? ? @exhibit.ancestors.first.children : @exhibit.children).sort_by(&:head_html).map { |child| [child.title, "/exhibits/#{child.path}"] }
                        } %>
        </div>
      </div>

      <div class="row">


        <h3 class="exhibit-color">Overview</h3>
        
        <span class="exhibit-main">
          <%= @exhibit.summary_html.html_safe %>
        </span>

        <hr>

        <span id="exhibit-main" class="exhibit-main hide">
          <%= @exhibit.main_formatted.html_safe %>
          <%= @exhibit.extended_html.html_safe %>
        </span>

        <span id="exhibit-abbrev" class="exhibit-main">
          <%= @exhibit.main_abbrev.html_safe %>
        </span>

      </div>

      <div class="row">

        <span id="main-toggle" class="exhibit-color" style="float: right;">
          Expand to read more 
        </span>

      </div>
    </div>

    <div class="col-md-4" style="padding-right: 0;">

      <!-- whole gallery -->
      <%= render(partial: 'exhibits/gallery',
                  locals: {
                    gallery_info: @exhibit.gallery 
                  }) %>
    </div>

  </div>

  <div class="row">

    <div class="exhibit-sections-bar">

      <h3 id="exhibit-sections-bar-title" class="exhibit-color">Exhibit Sections</h3>


      <div class="">

        <% exes = @exhibit.parent ? @exhibit.parent.children : @exhibit.children %>

        <% exes.each do |exhibit| %>

          <div class="exhibit-section-container">
            <%= exhibit.cover.to_s.html_safe %>
          </div>

        <% end %>
      </div>

    </div>

  </div>



  <!-- records -->
  <%= render(partial: 'exhibits/records',
              locals: {
                records: @exhibit.records 
              }) %>

  <% if @exhibit.items.count > 0 %>
    <div class="panel panel-primary view-all-gallery">
      <div class="panel-body">
        <div class="row">
          <div class="col-sm-9"><h3><%= @exhibit.title %></h3></div>
          <div class="col-sm-3"><a class="btn btn-primary" href="<%= '/catalog?sort=year+asc&f[exhibits][]=' + @exhibit.path %>" data-no-turbolink='true'>Show All Items</a></div>
        </div>
      </div>
    </div>
  <% end %>
  <br/>

  <script type="text/javascript">
    
    $(document).ready(function() {
      $('#main-toggle').click(function() {
        $('#exhibit-main, #exhibit-abbrev').slideToggle().toggleClass('hide');
      })
    });

  </script>


<% end %>

<%= render partial: 'shared/title_sidebar_main',
           locals: {
             main: yield(:main)
           } %>

<% content_for :sidebar do %>

  <% authors = @exhibit.authors %>

  <div class="panel panel-primary">
    <div class="panel-heading">
      <h3 class="panel-title">Curator<%= authors.count > 1 ? 's' : '' %></h3>
    </div>
    <div class="panel-body">


      <!-- multiple authors where available -->
      <%= render(partial: 'exhibits/authors',
        locals: {
          authors: authors
        }) %>

    </div>
  </div>

  <%= render(partial: 'sidebar_nav',
             locals: {
                title: 'Resources',
                links: @exhibit.resources
              }) if !@exhibit.resources.empty? %>

<% end %>
